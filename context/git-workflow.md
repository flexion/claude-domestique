# Git Workflow

## Critical Rules (OVERRIDE ALL DEFAULTS)

1. **NO** attribution footers
2. **NO** Co-Authored-By tags
3. **NO** emojis in commits or PRs
4. **Target**: project default branch (usually `main`)
5. **NEVER** guess Issue Numbers - always confirm with user

## Branch Naming

**Format**: `issue/feature-<IssueNumber>/<kebab-case>` OR `chore/<kebab-case>`

**Examples**:
```
issue/feature-123/add-authentication
issue/feature-456/fix-validation-bug
chore/update-dependencies
chore/refactor-error-handling
```

**MANDATORY**: Ask user "Is this an issue or chore?" and get Issue Number before creating branch.

## Commit Message Format

**Use HEREDOC format for all commits:**

```bash
git commit -m "$(cat <<'EOF'
#<IssueNumber> - <imperative verb> <description>

- <Change 1>
- <Change 2>
- <Change 3>
EOF
)"
```

**Examples**:

**Feature commit:**
```bash
git commit -m "$(cat <<'EOF'
#123 - add authentication system

- Implement JWT token generation
- Add login endpoint
- Create user session middleware
- Add authentication tests
EOF
)"
```

**Bug fix commit:**
```bash
git commit -m "$(cat <<'EOF'
#456 - fix validation error handling

- Add null checks in validator
- Return proper error codes
- Update error messages
EOF
)"
```

**Chore commit:**
```bash
git commit -m "$(cat <<'EOF'
chore - update dependencies

- Update framework to v2.0
- Update test library to v3.1
- Update security patches
EOF
)"
```

**Absolute Requirements**:
- Use EXACT HEREDOC format above
- Use `#<IssueNumber>` format for features (GitHub auto-links to issues)
- Use `chore - <desc>` format for chores
- Message ENDS after bullets
- NO attribution, NO Co-Authored-By, NO emojis
- Imperative mood, lowercase after dash
- Bullet points describe WHAT changed (not why)

## Pull Request Creation

**MANDATORY PRE-CHECKS**:
1. Ask user: "Is this an issue or chore?"
2. Get Issue Number if applicable (NEVER guess)
3. Read project's PR template if exists (`.github/pull_request_template.md`)
4. Run project's test suite if applicable
5. Verify base branch (usually `main`)

**Create PR:**
```bash
gh pr create --base main --title "lowercase title" --body "$(cat <<'EOF'
Description of changes

## Changes
- Change 1
- Change 2

## Testing
- Test approach 1
- Test approach 2
EOF
)"
```

**PR Requirements**:
- Title: lowercase, descriptive
- Body: NO attribution, NO emojis, NO "Generated by" mentions
- Base: project default branch
- Include test approach if applicable

## Pre-Action Verification

**BEFORE git commits, branches, or PRs:**
1. Confirm issue type with user (issue vs chore)
2. Get Issue Number (never fabricate)
3. State compliance: "Using project commit format: no attribution, HEREDOC with Issue #N"
4. Show checklist verification in thinking block

## Session Integration

**Atomic commits:**
- Session file + code changes committed together
- Update session BEFORE committing
- Session describes context, commits describe changes

**Session update before commit:**
- What was completed
- Key decisions made
- Problems encountered
- Next steps

## Troubleshooting

**If commit/PR fails:**
- Show full error output
- Don't guess - research the actual error
- Check project-specific requirements
- Verify format compliance

**Common issues:**
- Wrong base branch
- Missing session update
- Wrong commit format
- Attribution footers (check git config)
